Разработка ОС в Windows
===============================================

Необходимо
----------------------------

Весь софт доступен в облаке - https://yadi.sk/d/PsOgea_B_uqTmg

- MinGW
	- Скачать и установить `MinGW`
	- Установить в `C:\MinGW\`
- i686-elf компилятор (GCC)
	- Скачать и распаковать `ghost-i686-elf-tools`
	- Распаковать в `C:\software\ghost-i686-elf-tools` так, чтобы следующей была папка `bin`: `C:\software\ghost-i686-elf-tools\bin`
- QEMU (эмулятор)
	- Скачать последний x64 установщик из http://qemu.weilnetz.de/w64/ или файл с облака
	- Установить в `C:\Program Files\qemu`
- mingw-get (при возникновении проблем)
	- Скачать и установить в любую папку с облака или с другого источника
	- Использование: `mingw-get install название_либы` 


Сборка и запуск ОС
----------------------------

0. Если софт установлен в другие папки, то см. ниже проблему 2
1. Установите все указанное выше
2. Отредактируйте `vars.cmd` так, чтобы переменные указывали на папки, куда устанавливались программы:
	- установите `minGW` переменную в директорию `bin` MinGW: `SET "minGW=C:\MinGW\bin"`
	- установите `gcc` перменную в папку `bin` компилятора `gcc`: `SET "gcc=C:\software\ghost-i686-elf-tools\bin"`
	- установите `qemu` переменную в папку с эмулятором `qemu`: `SET "qemu=C:\Program Files\qemu"`
3. Отредактируйте Makefile (в начале файла также как и в `vars.cmd` прописать пути к программам)
4. Запустите `build_and_run.bat`, чтобы собрать ОС и запустить в QEMU
	- Запустите `run.bat`, чтобы запустить ОС в QEMU (подразумевается, что сборка была произведена раньше)
5. Запуск через Makefile (необходим установленный make)
	- Откройте командную строку в корневой директории этого проекта
	- Введите команду `make`


Структура проекта
----------------------------
- bin/boot - os.bin - бинарник ОС
- bin/boot/grub - grub.cfg - конфигурация Grub

---

- build - linker.ld - файл конфигурации линкера
- build - *.o - объектные файлы

---

- src - исходный код ОС
- src - kernel.* - исходники ядра
- src/modules - исходный код модулей

--- 

- vars.cmd - файл с переменными
- build_and_run.bat - батник для билда ОС и запусука ее в QEMU
- run.bat - батник для запуска ОС в QEMU
- Makefile - делает то же самое, что и build_and_run.ba


Проблемы
----------------------------
1. При запуске не найдена какая-то либа из MinGW
	- Решение: Скачать mingw-get. Выполнить команду mingw-get install название_либы
2. Программы установлены не в рекоммендованные выше директории
	- Решение: Создать `vars.local.cmd` скопировав `vars.cmd`, заменив переменные на свои директории. Далее запускать только с батников


Полезные ссылки
----------------------------

- [OSdev.org](http://wiki.osdev.org)
- Софт - https://yadi.sk/d/PsOgea_B_uqTmg